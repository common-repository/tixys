Tx.AjaxCall=function(){var t={url:"",request:"",indicator:null,messageHandler:new Tx.MessageAlert,dataType:"json",callback:Tx.nullFunc,processType:"api"},e=function(t){return(!t||"object"!=typeof t||Tx.isUndefined(t.payload)||Tx.isUndefined(t.MessageList))&&(t={success:!1,payload:[],MessageList:[{type:"error",source:"system",text:Tx.L10n.t("Call failed or returned an invalid response.")}]}),t},n=function(t,e){var n=/#e#:[0-9]+/,r=function(t){var i=jQuery.type(t),a=t;return"object"===i?(a={},jQuery.each(t,function(t,e){a[t]=r(e)})):"array"===i?(a=[],jQuery.each(t,function(t,e){a.push(r(e))})):"string"===i&&t.match(n)&&(a=r(e[t])),a};return r(t)},r=function(e){var n=0,r=[],i=t.messageHandler;if(i.reset&&i.reset(),e.length>0){for(n;n<e.length;n++)r.push(new Tx.UserMessage(e[n].type,e[n].source,e[n].text));i.setMessages(r),i.showMessages()}},i=function(i){var a=i;Tx.inArray(t.processType,["api","apicomplete"])?(a=e(i),r(a.MessageList),a.payload=n(a.payload,a.entityList),t.callback("api"===t.processType?a.payload:a)):"raw"===t.processType&&t.callback(a),t.indicator&&t.indicator.finish()};this.setParam=function(e,n){Tx.isUndefined(t[e])||(t[e]=n)},this.getParam=function(e){return Tx.isUndefined(t[e])?null:t[e]},this.doCall=function(){var e={type:"POST",url:t.url,data:t.request,success:i,error:i,dataType:t.dataType,cache:!1,timeout:12e4};"jsonp"===t.dataType&&(e.type="GET",e.url+=".jsonp"),Tx.token&&(e.headers={"X-Token":Tx.token}),jQuery.ajax(e),t.indicator&&t.indicator.show()}},Tx.ApiEndpoints={"shop.v1/Station.search":"shop.v1/StationSearch","shop.v1/Station.searchDepartures":"shop.v1/StationSearch","shop.v1/Station.searchDestinations":"shop.v1/StationSearch","shop.v1/Station.get":"common/Id"},Tx.ApiObjects={"shop.v1/Station":{id:null,name:null,description:null,lon:null,lat:null,timezone:null},"shop.v1/StationSearch":{Site:null,name:null,Maparea:null,Station:null}},Tx.Endpoint=function(t,e){var n=e||{},r="string"==typeof Tx.ApiEndpoints[t],i=r?t:"",a=r?Tx.ApiEndpoints[i]:"",o=new Tx.AjaxCall;if(!r)throw Tx.sprintf("Invalid endpoint: %s",t);this.createRequestObject=function(t){return new Tx.RequestObject(a,t)},this.execute=function(){var t=o.getParam("request");t+=(t.length?"&":"?")+"locale="+Tx.config.locale,o.setParam("url",Tx.config.apiBase+"/"+i),o.setParam("request",t),o.doCall()},this.setParam=function(t,e){o.setParam(t,e)},this.setRequest=function(t){if("object"!=typeof t||"function"!=typeof t.getName)throw"Invalid request object.";if(t.getName()!==a)throw Tx.sprintf("Wrong request object, expected %s, got %s",a,t.getName());o.setParam("request","request="+JSON.stringify(t).replace(/\+/g,"%2b").replace(/&/g,"%26"))},this.setIndicator=function(t){o.setParam("indicator",t)},this.setMessageHandler=function(t){o.setParam("messageHandler",t)},this.setCallback=function(t){o.setParam("callback",t)},jQuery.each(n,function(t,e){o.setParam(t,e)})},Tx.isNull=function(t){return null===t},Tx.isUndefined=function(t){return void 0===t},Tx.objectToArray=function(t,e){var n=[];return jQuery.each(t,function(t,r){n.push(e&&"keys"===e?t:r)}),n},Tx.getObjectKeys=function(t){return Tx.objectToArray(t,"keys")},Tx.arrayMap=function(t,e){var n=0;for(n;n<e.length;n++)e[n]=t(e[n]);return e},Tx.trim=function(t){return Tx.isUndefined(t.replace)&&(t=t.toString()),t=t.replace(/^\s+/,""),t=t.replace(/\s+$/,"")},Tx.toInt=function(t){var e;return"boolean"==typeof t?e=t?1:0:("string"==typeof t&&(t=t.replace(",",".")),e=parseInt(t,10)),isNaN(e)&&(e=0),e},Tx.toFloat=function(t){"string"==typeof t&&(t=t.replace(",","."));var e=parseFloat(t);return isNaN(e)&&(e=0),e},Tx.toBool=function(t){return!!Tx.toInt(t)},Tx.vsprintf=function(t,e){var n=0;if(!e||!e.length)return t;for(n;n<e.length;n++)t=t.replace(/%s/,e[n]);return t},Tx.sprintf=function(t){var e=[];return jQuery.each(arguments,function(t,n){t&&e.push(n)}),Tx.vsprintf(t,e)},Tx.stopEvent=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},Tx.currencyFormat=function(t){var e=Math.floor(t),n=100*t-100*e;return n=Math.round(n),0===n?n="00":10>n&&(n="0"+n),e+Tx.L10n.tc(".|decimal separator")+n},Tx.varpad=function(t,e,n){for(var r=t.toString(),i=e||2,a=n?n.toString():" ";r.length<i;)r=a+r;return r},Tx.numpad=function(t,e){return Tx.varpad(t,e,"0")},Tx.inArray=function(t,e,n){var r=n||!1,i=!1;return Tx.isUndefined(e)||Tx.isNull(e)||jQuery.each(e,function(e,n){return r&&t===n||!r&&t==n?(i=!0,!1):void 0}),i},Tx.collectFormValues=function(t,e){var n={},r=e||"";return jQuery(t).find("input[name], select[name], textarea[name]").each(function(){var t=null,e=jQuery(this),i=e.attr("name");r&&0!==i.indexOf(r)||"true"===e.attr("data-ignore")||(i=i.substr(r.length),t=e.getFieldValue(),Tx.isNull(t)||Tx.isUndefined(t)||Tx.isNull(i)||Tx.isUndefined(i)||("List"!==i.substr(-4,4)||jQuery.isArray(t)?n[i]=t:(jQuery.isArray(n[i])||(n[i]=[]),n[i].push(t))))}),n},Tx.redirect=function(t){window.location.href=t},Tx.nullFunc=function(){},Tx.appendParams=function(t,e,n){var r=t||"",i=e||{},a=n||"",o="&";return"html"===a?o="&amp;":"url"===a&&(o="%26"),jQuery.each(i,function(t,e){r+=(-1===r.indexOf("?")?"?":o)+Tx.sprintf("%s=%s",t,e)}),r},Tx.findObjectInList=function(t,e,n){var r=0,i=null,a=n||"id";for(r;r<t.length;r++)if(t[r][a]==e){i=t[r];break}return i},Tx.removeObjectFromList=function(t,e,n){var r=0,i=[],a=n||"id";for(r;r<t.length;r++)t[r][a]!=e&&i.push(t[r]);return i},Tx.findObjectsInList=function(t,e,n){var r,i=[],a=0,o=n||"id";for(a;a<e.length;a++)r=Tx.findObjectInList(t,e[a],o),r&&r[o]&&i.push(r);return i},Tx.esc=function(t){var e={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#038;"};return jQuery.each(e,function(e,n){"string"==typeof t&&(t=t.replace(new RegExp(e,"g"),n))}),t},Tx.out=function(t){return t=Tx.esc(t),void 0!==window.Tx.L10n&&(t=Tx.L10n.mlStringTranslate(t,Tx.config.locale)),t},Tx.L10n={t:function(t){return Tx.isUndefined(window.messages)||Tx.isUndefined(window.messages[t])?t:window.messages[t]},tc:function(t){var e=Tx.L10n.t(t),n=e.lastIndexOf("|");return-1===n?e:e.slice(0,n)},tn:function(t,e){var n=Tx.L10n.t(t),r=n.indexOf("|")>0?n.split("|"):[n,n];return Tx.sprintf(1===e?r[0]:r[1],e)},u:function(t){return Tx.L10n.mlStringTranslate(t,Tx.config.locale)},formatDay:function(t,e){return new Date(t.y,t.m-1,t.d).format(e||Tx.L10n.t("Y/m/d"))},formatTimeofday:function(t,e){return new Date(2e3,1,1,t.h,t.m).format(e||Tx.L10n.t("H:i"))},formatTime:function(t,e,n){return new Date(t.y,t.m-1,t.d,e.h,e.m).format(n||Tx.L10n.t("Y/m/d H:i"))},formatDuration:function(t){var e=Math.floor(t/60);return Tx.sprintf("%sh %smin",e,t-60*e)},mlStringToObj:function(t){var e=new RegExp("\\[:(?=[a-z]{2}\\])","g"),n={};return"string"==typeof t&&jQuery.each(t.split(e),function(t,e){var r=e.substr(0,2),i=e.substr(3);e.length>=3&&e.substr(0,3).match(/[a-z]{2}\]/)&&(n[r]=i)}),n},mlStringTranslate:function(t,e){var n,r=e.substr(0,2),i=Tx.config.locale.substr(0,2),a=t;return"string"==typeof t&&t.match(/\[:[a-z]{2}\]/)&&(n=Tx.L10n.mlStringToObj(t),a="string"==typeof n[r]?n[r]:"string"==typeof n[i]?n[i]:"string"==typeof n.en?n.en:""),a}},Tx.IndicatorNoop=function(){var t=Tx.nullFunc;this.setCallback=function(e){t=e},this.show=Tx.nullFunc,this.finish=function(e){t()}},Tx.IndicatorSpinner=function(t){var e=Tx.nullFunc;this.setCallback=function(t){e=t},this.show=function(){t.show()},this.finish=function(n){t.hide(),e()}},"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,r,i,a,o,s=gap,u=e[t];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(t)),"function"==typeof rep&&(u=rep.call(e,t,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(u)){for(a=u.length,n=0;a>n;n+=1)o[n]=str(n,u)||"null";return i=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+s+"]":"["+o.join(",")+"]",gap=s,i}if(rep&&"object"==typeof rep)for(a=rep.length,n=0;a>n;n+=1)"string"==typeof rep[n]&&(r=rep[n],i=str(r,u),i&&o.push(quote(r)+(gap?": ":":")+i));else for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(i=str(r,u),i&&o.push(quote(r)+(gap?": ":":")+i));return i=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+s+"}":"{"+o.join(",")+"}",gap=s,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(t){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(t){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var n,r,i=t[e];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),void 0!==r?i[n]=r:delete i[n]);return reviver.call(t,e,i)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),Tx.MessageAlert=function(){var t=[];this.reset=Tx.nullFunc,this.setMessages=function(e){t=e},this.showMessages=function(){var e=0,n=[],r="";if(1===t.length)r=t[0].getText();else{for(e;e<t.length;e++)n.push("• "+t[e].getText());r=n.join("\n")}alert(r)}},Tx.RequestObject=function(t,e){var n=this,r=e||{},i=function(e){if(Tx.isUndefined(n[e]))throw Tx.sprintf("Object %s does not have a property named %s.",t,e)};if(Tx.isUndefined(Tx.ApiObjects[t]))throw Tx.sprintf("Object does not exist: %s",t);jQuery.each(Tx.ApiObjects[t],function(t,e){n[t]=Tx.isUndefined(r[t])?e:r[t]}),this.set=function(t,e){i(t),n[t]=e},this.get=function(t){return i(t),n[t]},this.getName=function(){return t}},Tx.UserMessage=function(t,e,n){var r=t||"info",i=n||"",a=e||"user";this.getType=function(){return r},this.getSource=function(){return a},this.getText=function(){return i}};